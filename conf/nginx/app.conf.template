
events {}

http {
  upstream app {
    server localhost:8080;
  }

  server {
    server_name _;
    listen $PORT;

    access_log /dev/stdout;
    error_log /dev/stdout;

    location / {
      try_files $uri @backend;
    }

    location /(css|js|fonts|img)/ {
      include /etc/nginx/mime.types;

      access_log off;
      expires 1d;

      root /app/static;
      try_files $uri @backend;
    }

    location @backend {
      proxy_set_header X-Real-IP  $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header Host $http_host;
      proxy_redirect off;

      proxy_pass http://app;
    }
  }
}
